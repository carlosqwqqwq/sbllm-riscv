# RISC-V ä»£ç è‡ªåŠ¨ä¼˜åŒ–æ¡†æ¶

## ğŸ“– é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®åŸºäº SBLLMï¼ˆSearch-Based LLMs for Code Optimizationï¼‰æ¡†æ¶ï¼Œé’ˆå¯¹ RISC-V æ¶æ„ä»£ç ä¼˜åŒ–åœºæ™¯è¿›è¡Œäº†æ·±åº¦å®šåˆ¶å’Œå¢å¼ºã€‚é€šè¿‡å¼•å…¥æ³¨é‡Šè¯­ä¹‰åˆ†æã€QEMU ä»¿çœŸè¯„ä¼°ã€äººå·¥ä¼˜åŒ–è¡¥ä¸çŸ¥è¯†åº“å’Œæ··åˆæ£€ç´¢ç­‰å…³é”®æŠ€æœ¯ï¼Œå®ç°äº†ä»å…¶ä»–æ¶æ„åˆ° RISC-V æ¶æ„çš„ä»£ç è‡ªåŠ¨è¿ç§»å’Œä¼˜åŒ–ã€‚

### æ ¸å¿ƒä»·å€¼

- ğŸ¯ **è‡ªåŠ¨åŒ–ä¼˜åŒ–**ï¼šæ— éœ€æ‰‹åŠ¨åˆ†æï¼Œè‡ªåŠ¨ç”Ÿæˆå¤šä¸ªä¼˜åŒ–å€™é€‰
- ğŸ” **æ™ºèƒ½æ£€ç´¢**ï¼šåŸºäºçŸ¥è¯†åº“çš„æ··åˆæ£€ç´¢ï¼Œå¤ç”¨å†å²ä¼˜åŒ–ç»éªŒ
- âœ… **ä¸¥æ ¼éªŒè¯**ï¼šQEMU ä»¿çœŸç¯å¢ƒç¡®ä¿åŠŸèƒ½æ­£ç¡®æ€§å’Œæ€§èƒ½æå‡
- ğŸš€ **é«˜æ•ˆè¿­ä»£**ï¼šé—ä¼ ç®—æ³•é©±åŠ¨çš„è¿­ä»£ä¼˜åŒ–ï¼ŒæŒç»­æ”¹è¿›ä»£ç æ€§èƒ½

### é€‚ç”¨åœºæ™¯

- ä» x86/ARM æ¶æ„è¿ç§»åˆ° RISC-V çš„ä»£ç ä¼˜åŒ–
- RISC-V æ±‡ç¼–ä»£ç çš„æ€§èƒ½ä¼˜åŒ–
- RISC-V C ä»£ç çš„æŒ‡ä»¤çº§ä¼˜åŒ–
- åˆ©ç”¨ RISC-V ç‰¹æ€§ï¼ˆå‹ç¼©æŒ‡ä»¤ã€æµæ°´çº¿ç­‰ï¼‰çš„ä»£ç ä¼˜åŒ–

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### 1. æ³¨é‡Šé©±åŠ¨çš„ä¼˜åŒ–å»ºè®®ç”Ÿæˆ

- âœ… ä½¿ç”¨ LLM åˆ†æ RISC-V ä»£ç æ³¨é‡Šï¼Œæå–åŠŸèƒ½æ„å›¾å’Œä¼˜åŒ–æ–¹å‘
- âœ… ç”Ÿæˆç»“æ„åŒ–çš„ä¼˜åŒ–å»ºè®®ï¼ˆreview commentsï¼‰ï¼ŒæŒ‡å¯¼åç»­ä»£ç ç”Ÿæˆ
- âœ… æ”¯æŒå¤šç§ LLM æ¨¡å‹ï¼ˆChatGPTã€GPT-4ã€Geminiã€DeepSeekã€CodeLlamaï¼‰

### 2. QEMU ä»¿çœŸç¯å¢ƒè¯„ä¼°

- âœ… åœ¨çœŸå®çš„ QEMU RISC-V ä»¿çœŸç¯å¢ƒä¸­è¿è¡Œå’Œæµ‹è¯•ä»£ç 
- âœ… è¯„ä¼°åŠŸèƒ½æ­£ç¡®æ€§ã€æ‰§è¡Œæ—¶é—´å’Œä»£ç ä½“ç§¯ä¸‰ä¸ªç»´åº¦
- âœ… æ”¯æŒæ±‡ç¼–ä»£ç å’Œ C ä»£ç çš„ç¼–è¯‘ä¸æ‰§è¡Œ
- âœ… åŠŸèƒ½æ­£ç¡®æ€§æ£€æŸ¥ï¼šè¾“å‡ºæ¯”è¾ƒã€æ•°å€¼å®¹å·®ã€è¿”å›ç éªŒè¯

### 3. æ··åˆæ£€ç´¢çŸ¥è¯†åº“

- âœ… ç»“åˆ BM25 å…³é”®è¯æ£€ç´¢å’Œå‘é‡è¯­ä¹‰æ£€ç´¢
- âœ… ä»äººå·¥ä¼˜åŒ–è¡¥ä¸æ•°æ®é›†ä¸­æ£€ç´¢ Similar Pattern å’Œ Different Pattern
- âœ… æ”¯æŒçµæ´»çš„æ£€ç´¢ç­–ç•¥é…ç½®ï¼ˆBM25 / å‘é‡ / æ··åˆï¼‰
- âœ… FAISS å‘é‡ç´¢å¼•æ”¯æŒï¼Œå¿«é€Ÿæ£€ç´¢

### 4. é—ä¼ ç®—æ³•è¿­ä»£ä¼˜åŒ–

- âœ… ä½¿ç”¨ Similar Pattern ä½œä¸ºä¸»å¯¼ä¼˜åŒ–æ–¹å‘
- âœ… å¼•å…¥ Different Pattern ä½œä¸º"çªå˜"æ“ä½œï¼Œæ¢ç´¢æ–°çš„ä¼˜åŒ–è·¯å¾„
- âœ… è¿­ä»£ä¼˜åŒ–ç›´åˆ°æ€§èƒ½æ”¶æ•›
- âœ… è‡ªåŠ¨åœæ­¢æœºåˆ¶ï¼šå½“ä¼˜åŒ–æ”¶æ•›æ—¶è‡ªåŠ¨åœæ­¢è¿­ä»£

### 5. æ€§èƒ½ä¼˜åŒ–ç‰¹æ€§

- âœ… **ç¼–è¯‘ç¼“å­˜**ï¼šåŸºäºä»£ç å“ˆå¸Œçš„ç¼–è¯‘ç»“æœç¼“å­˜ï¼Œé¿å…é‡å¤ç¼–è¯‘
- âœ… **å¹¶è¡Œè¯„ä¼°**ï¼šä½¿ç”¨çº¿ç¨‹æ± å¹¶è¡Œè¯„ä¼°å¤šä¸ªå€™é€‰ä»£ç 
- âœ… **æ™ºèƒ½ç¼“å­˜**ï¼šè‡ªåŠ¨ç¼“å­˜ç¼–è¯‘ç»“æœï¼Œæ˜¾è‘—æå‡è¯„ä¼°é€Ÿåº¦ï¼ˆ5-10 å€æå‡ï¼‰

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è¾“å…¥: RISC-V ä»£ç ï¼ˆå«æ³¨é‡Šï¼‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          [æ¨¡å—ä¸€] ç”Ÿæˆä¼˜åŒ–å€™é€‰é›†                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. è¯­ä¹‰æå–ï¼šLLM åˆ†æä»£ç æ³¨é‡Š                          â”‚  â”‚
â”‚  â”‚    â†’ æå–åŠŸèƒ½æ„å›¾å’Œä¼˜åŒ–æ–¹å‘                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2. ç”Ÿæˆä¼˜åŒ–å»ºè®®ï¼šåŸºäºåˆ†æç»“æœç”Ÿæˆ review comments     â”‚  â”‚
â”‚  â”‚    â†’ ç»“æ„åŒ–ä¼˜åŒ–å»ºè®®ï¼ˆæ¡ä»¶åˆ†æ”¯ã€å†…å­˜ã€æŒ‡ä»¤é›†ç­‰ï¼‰        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 3. ç”Ÿæˆå€™é€‰ä»£ç ï¼šç»“åˆå»ºè®®å’ŒåŸå§‹ä»£ç ç”Ÿæˆå¤šä¸ªç‰ˆæœ¬        â”‚  â”‚
â”‚  â”‚    â†’ ç”Ÿæˆ 3-8 ä¸ªä¸åŒä¼˜åŒ–æ€è·¯çš„å€™é€‰ä»£ç                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          [æ¨¡å—äºŒ] æ ·æœ¬ç­›é€‰ï¼ˆQEMU è¯„ä¼°ï¼‰                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. ç¼–è¯‘ä¸º RISC-V äºŒè¿›åˆ¶                                â”‚  â”‚
â”‚  â”‚    â†’ æ”¯æŒæ±‡ç¼–å’Œ C ä»£ç ï¼Œè‡ªåŠ¨è¯†åˆ«ä»£ç ç±»å‹              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2. QEMU ä»¿çœŸæ‰§è¡Œ                                       â”‚  â”‚
â”‚  â”‚    â†’ åœ¨çœŸå® RISC-V ç¯å¢ƒä¸­è¿è¡Œ                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 3. ä¸‰ç»´è¯„ä¼°                                           â”‚  â”‚
â”‚  â”‚    âœ“ åŠŸèƒ½æ­£ç¡®æ€§ï¼šè¾“å‡ºæ¯”è¾ƒ + è¿”å›ç æ£€æŸ¥                â”‚  â”‚
â”‚  â”‚    âœ“ æ‰§è¡Œæ—¶é—´ï¼šå¤šæ¬¡è¿è¡Œå–å¹³å‡å€¼                        â”‚  â”‚
â”‚  â”‚    âœ“ ä»£ç ä½“ç§¯ï¼šä½¿ç”¨ size/objdump è·å–                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 4. ç­›é€‰æ’åºï¼šæ’é™¤ä¸æ­£ç¡®æ ·æœ¬ï¼ŒæŒ‰æ€§èƒ½æŒ‡æ ‡æ’åº            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          [æ¨¡å—ä¸‰] çŸ¥è¯†åº“æ¨¡æ¿æ£€ç´¢                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. æ··åˆæ£€ç´¢ï¼ˆBM25 + å‘é‡æ£€ç´¢ï¼‰                        â”‚  â”‚
â”‚  â”‚    â†’ BM25ï¼šå…³é”®è¯åŒ¹é…                                 â”‚  â”‚
â”‚  â”‚    â†’ å‘é‡æ£€ç´¢ï¼šè¯­ä¹‰ç›¸ä¼¼åº¦ï¼ˆFAISSï¼‰                    â”‚  â”‚
â”‚  â”‚    â†’ åŠ æƒèåˆä¸¤ç§æ£€ç´¢ç»“æœ                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2. æ£€ç´¢ Similar Pattern                               â”‚  â”‚
â”‚  â”‚    â†’ ä¸å½“å‰ä»£ç æœ€ç›¸ä¼¼çš„ä¼˜åŒ–æ¨¡å¼                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 3. æ£€ç´¢ Different Pattern                             â”‚  â”‚
â”‚  â”‚    â†’ è¯­ä¹‰ç›¸ä¼¼ä½†ä¼˜åŒ–é€»è¾‘ä¸åŒçš„æ¨¡å¼ï¼ˆç”¨äºæ¢ç´¢ï¼‰          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          [æ¨¡å—å››] é—ä¼ è¿­ä»£ä¼˜åŒ–                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. ç»“åˆ Pattern ç”Ÿæˆæ–°ç‰ˆæœ¬                            â”‚  â”‚
â”‚  â”‚    â†’ Similar Patternï¼šä¸»å¯¼ä¼˜åŒ–æ–¹å‘ï¼ˆç¨³å®šæ€§ï¼‰            â”‚  â”‚
â”‚  â”‚    â†’ Different Patternï¼šçªå˜æ“ä½œï¼ˆæ¢ç´¢æ€§ï¼‰             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2. QEMU è¯„ä¼°æ–°ç‰ˆæœ¬                                     â”‚  â”‚
â”‚  â”‚    â†’ éªŒè¯åŠŸèƒ½æ­£ç¡®æ€§å’Œæ€§èƒ½æå‡                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 3. è¿­ä»£åˆ¤æ–­                                           â”‚  â”‚
â”‚  â”‚    â†’ æå‡æ˜¾è‘—ï¼šç»§ç»­è¿­ä»£                                â”‚  â”‚
â”‚  â”‚    â†’ æ€§èƒ½æ”¶æ•›ï¼šåœæ­¢è¿­ä»£                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              è¾“å‡º: ä¼˜åŒ–åçš„ RISC-V ä»£ç                        â”‚
â”‚          âœ“ åŠŸèƒ½æ­£ç¡®ï¼ˆ100% æ­£ç¡®æ€§ï¼‰                          â”‚
â”‚          âœ“ æ€§èƒ½æå‡ï¼ˆæ‰§è¡ŒåŠ é€Ÿæ¯”ï¼‰                            â”‚
â”‚          âœ“ ä½“ç§¯ä¼˜åŒ–ï¼ˆä»£ç ä½“ç§¯ç¼©å‡ï¼‰                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

- **LLM æ¨¡å‹**ï¼šOpenAI GPTã€Google Geminiã€DeepSeekã€CodeLlama
- **è¯„ä¼°ç¯å¢ƒ**ï¼šQEMU RISC-V ä»¿çœŸå™¨
- **ç¼–è¯‘å·¥å…·**ï¼šRISC-V GCC å·¥å…·é“¾
- **æ£€ç´¢æŠ€æœ¯**ï¼šBM25ã€FAISSã€Sentence Transformers
- **ä¼˜åŒ–ç®—æ³•**ï¼šé—ä¼ ç®—æ³•ã€è¿­ä»£ä¼˜åŒ–

## ç¯å¢ƒè¦æ±‚

### ç³»ç»Ÿè¦æ±‚

- Python 3.9.12
- Linux ç³»ç»Ÿï¼ˆæ¨è Ubuntu 20.04+ï¼‰
- QEMUï¼ˆqemu-riscv64ï¼‰
- RISC-V GCC å·¥å…·é“¾ï¼ˆriscv64-unknown-linux-gnu-gccï¼‰

### Python ä¾èµ–

å®‰è£…ä¾èµ–ï¼š

```bash
pip install -r requirement.txt
```

ä¸»è¦ä¾èµ–åŒ…æ‹¬ï¼š

- `jsonlines==4.0.0`
- `numpy==1.26.1`
- `openai==0.28.1`
- `tqdm==4.66.1`
- `google-generativeai==0.3.2`
- `rank_bm25==0.2.2`
- `editdistance==0.6.2`
- `tree-sitter==0.20.4`
- `faiss-cpu==1.7.4` â­ æ–°å¢
- `sentence-transformers==2.2.2` â­ æ–°å¢
- `pandas==2.0.3` â­ æ–°å¢

### å¤–éƒ¨å·¥å…·å®‰è£…

#### 1. å®‰è£… QEMU

```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install qemu-system-riscv64 qemu-user-riscv64

# éªŒè¯å®‰è£…
qemu-riscv64 --version
```

#### 2. å®‰è£… RISC-V GCC å·¥å…·é“¾

```bash
# ä¸‹è½½é¢„ç¼–è¯‘å·¥å…·é“¾
wget https://github.com/riscv/riscv-gnu-toolchain/releases/download/xxx/riscv64-unknown-linux-gnu.tar.gz
tar -xzf riscv64-unknown-linux-gnu.tar.gz
export PATH=$PATH:/path/to/riscv64-unknown-linux-gnu/bin

# éªŒè¯å®‰è£…
riscv64-unknown-linux-gnu-gcc --version
```

## é…ç½®è¯´æ˜

### 1. API å¯†é’¥é…ç½®

ç¼–è¾‘ `sbllm/sbllm/evol_query.py`ï¼Œå¡«å…¥ä½ çš„ API å¯†é’¥ï¼š

```python
llama_api_keys = [
    "your-codellama-api-key",
]

openai_api_keys = [
    'your-openai-api-key',
]

gemini_api_keys = [
    "your-gemini-api-key"
]

deepseek_api_keys = [
    "your-deepseek-api-key",
]
```

**æ”¯æŒçš„æ¨¡å‹**ï¼š

- `deepseek`: ä½¿ç”¨ DeepSeek APIï¼ˆ**é»˜è®¤æ¨è**ï¼‰
  - ä½¿ç”¨ OpenAI å…¼å®¹æ ¼å¼
  - base_url: `https://api.deepseek.com`
  - model: `deepseek-chat` (å¯¹åº” DeepSeek-V3.2-Exp çš„éæ€è€ƒæ¨¡å¼)
  - å‚è€ƒæ–‡æ¡£: <https://platform.deepseek.com/api-docs/>
- `chatgpt` / `gpt4`: ä½¿ç”¨ OpenAI API
- `gemini`: ä½¿ç”¨ Google Gemini API
- `codellama`: ä½¿ç”¨ DeepInfra CodeLlama API

### 2. æ•°æ®å‡†å¤‡

#### è®­ç»ƒæ•°æ®æ ¼å¼ï¼ˆçŸ¥è¯†åº“ï¼‰

å‡†å¤‡ä¼˜åŒ–è¡¥ä¸æ•°æ®é›†ï¼Œä¿å­˜ä¸º JSONL æ ¼å¼ï¼Œæ¯ä¸ªæ¡ç›®åŒ…å«ï¼š

```json
{
    "id": 1,
    "source": "æ¥æºåº“æˆ–é¡¹ç›®",
    "optimization_type": "æ¡ä»¶åˆ†æ”¯ä¼˜åŒ–",
    "optimization_description": "ä¼˜åŒ–æè¿°",
    "original_code": "åŸå§‹ä»£ç ",
    "optimized_code": "ä¼˜åŒ–åä»£ç ",
    "query_abs": "æŠ½è±¡åŒ–åçš„åŸå§‹ä»£ç ",
    "edit_code_abs": "åˆ é™¤éƒ¨åˆ†ï¼ˆdsï¼‰",
    "edit_opt_abs": "æ–°å¢éƒ¨åˆ†ï¼ˆdfï¼‰",
    "text_representation": "æ–‡æœ¬è¡¨ç¤ºï¼ˆç”¨äºå‘é‡æ£€ç´¢ï¼‰"
}
```

#### æµ‹è¯•æ•°æ®æ ¼å¼

æµ‹è¯•æ•°æ®åº”åŒ…å«å¾…ä¼˜åŒ–çš„ RISC-V ä»£ç ï¼š

```json
{
    "idx": 0,
    "query": "å¾…ä¼˜åŒ–çš„ RISC-V ä»£ç ï¼ˆå«æ³¨é‡Šï¼‰",
    "reference": "å‚è€ƒä¼˜åŒ–ä»£ç ï¼ˆå¯é€‰ï¼‰",
    "input": "æµ‹è¯•è¾“å…¥æ•°æ®ï¼ˆå¯é€‰ï¼‰"
}
```

## ğŸ“š ç”¨æˆ·ä½¿ç”¨æ‰‹å†Œ

### ğŸ§ª å¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èé¦–æ¬¡ä½¿ç”¨ï¼‰

åœ¨æ­£å¼ä½¿ç”¨æ¡†æ¶ä¹‹å‰ï¼Œå»ºè®®å…ˆè¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯ç¯å¢ƒé…ç½®å’ŒåŸºæœ¬åŠŸèƒ½ï¼š

```bash
cd sbllm/sbllm
bash test_riscv.sh \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu
```

**æ³¨æ„**ï¼šæµ‹è¯•è„šæœ¬é»˜è®¤ä½¿ç”¨ `deepseek` æ¨¡å‹ï¼Œç¡®ä¿å·²åœ¨ `evol_query.py` ä¸­é…ç½® DeepSeek API å¯†é’¥ã€‚

**æµ‹è¯•è„šæœ¬åŠŸèƒ½**ï¼š

- âœ… è‡ªåŠ¨ç¯å¢ƒéªŒè¯
- âœ… åˆ›å»ºæµ‹è¯•æ•°æ®
- âœ… è¿è¡Œä¸€æ¬¡ç®€åŒ–çš„ä¼˜åŒ–æµç¨‹
- âœ… éªŒè¯ç»“æœè¾“å‡º

**è¯¦ç»†æµ‹è¯•æ•™ç¨‹**ï¼šè¯·å‚è€ƒ `TEST_TUTORIAL.md`

### å¿«é€Ÿå¼€å§‹ï¼ˆ5 åˆ†é’Ÿä¸Šæ‰‹ï¼‰

#### å‰ç½®å‡†å¤‡

1. **å®‰è£…ä¾èµ–**

   ```bash
   # å®‰è£… Python ä¾èµ–
   pip install -r requirement.txt
   
   # å®‰è£… QEMUï¼ˆUbuntu/Debianï¼‰
   sudo apt-get install qemu-user-riscv64
   
   # å®‰è£… RISC-V GCC å·¥å…·é“¾
   # ä¸‹è½½å¹¶è§£å‹åˆ° /opt/riscv64-unknown-linux-gnu
   ```

2. **é…ç½® API å¯†é’¥**

   ç¼–è¾‘ `sbllm/sbllm/evol_query.py`ï¼Œå¡«å…¥ä½ çš„ API å¯†é’¥ï¼š

   ```python
   openai_api_keys = ['your-openai-api-key']
   gemini_api_keys = ["your-gemini-api-key"]
   # ... å…¶ä»– API å¯†é’¥
   ```

3. **å‡†å¤‡æ•°æ®**

   åˆ›å»ºæ•°æ®ç›®å½•å¹¶å‡†å¤‡æ•°æ®æ–‡ä»¶ï¼š

   ```bash
   mkdir -p processed_data/riscv
   # å°†æµ‹è¯•æ•°æ®æ”¾å…¥ processed_data/riscv/test.jsonl
   # å°†è®­ç»ƒæ•°æ®æ”¾å…¥ processed_data/riscv/train.jsonl
   ```

#### æ­¥éª¤ 1: ç¯å¢ƒéªŒè¯

åœ¨è¿è¡Œä¼˜åŒ–æ¡†æ¶ä¹‹å‰ï¼Œé¦–å…ˆéªŒè¯ç¯å¢ƒé…ç½®ï¼š

```bash
cd sbllm/sbllm
python validate_riscv_setup.py \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu
```

**éªŒè¯å†…å®¹**ï¼š

- âœ… QEMU å¯æ‰§è¡Œæ–‡ä»¶æ˜¯å¦å­˜åœ¨å¹¶å¯è¿è¡Œ
- âœ… RISC-V GCC å·¥å…·é“¾æ˜¯å¦å®Œæ•´ï¼ˆgcc, as, objdump, sizeï¼‰
- âœ… æ•°æ®æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®ï¼ˆtest.jsonl, train.jsonlï¼‰
- âœ… è¾“å‡ºç›®å½•æ˜¯å¦å¯å†™
- âœ… API å¯†é’¥æ˜¯å¦å·²é…ç½®ï¼ˆæ£€æŸ¥å ä½ç¬¦ï¼‰
- âœ… Python ä¾èµ–åŒ…æ˜¯å¦å·²å®‰è£…

**è¾“å‡ºç¤ºä¾‹**ï¼š

```
============================================================
RISC-V ç¯å¢ƒéªŒè¯
============================================================

1. æ£€æŸ¥ QEMU
------------------------------------------------------------
âœ“ QEMU: /usr/bin/qemu-riscv64
  ç‰ˆæœ¬ä¿¡æ¯: qemu-riscv64 version 6.2.0

2. æ£€æŸ¥ RISC-V GCC å·¥å…·é“¾
------------------------------------------------------------
âœ“ å·¥å…·é“¾å·¥å…·: riscv64-unknown-linux-gnu-gcc
âœ“ å·¥å…·é“¾å·¥å…·: riscv64-unknown-linux-gnu-as
...

âœ“ æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼ç¯å¢ƒé…ç½®æ­£ç¡®ã€‚
```

#### æ­¥éª¤ 2: è¿è¡Œä¼˜åŒ–æ¡†æ¶

ä½¿ç”¨ä¸€é”®è¿è¡Œè„šæœ¬ï¼ˆæ¨èï¼‰ï¼š

```bash
cd sbllm/sbllm
bash run_riscv.sh \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu
```

**æ³¨æ„**ï¼šè„šæœ¬é»˜è®¤ä½¿ç”¨ `deepseek` æ¨¡å‹ï¼Œç¡®ä¿å·²åœ¨ `evol_query.py` ä¸­é…ç½® DeepSeek API å¯†é’¥ã€‚

**è„šæœ¬è‡ªåŠ¨æ‰§è¡Œ**ï¼š

1. âœ… ç¯å¢ƒéªŒè¯ï¼ˆè°ƒç”¨ `validate_riscv_setup.py`ï¼‰
2. âœ… åˆå§‹åŒ–ç»“æœï¼ˆå¦‚éœ€è¦ï¼Œè°ƒç”¨ `initial.py`ï¼‰
3. âœ… è¿­ä»£ä¼˜åŒ–å¾ªç¯ï¼ˆé»˜è®¤ 4 æ¬¡è¿­ä»£ï¼‰
   - ç”Ÿæˆä¼˜åŒ–å€™é€‰ï¼ˆ`evol_query.py`ï¼‰
   - QEMU è¯„ä¼°å€™é€‰ä»£ç ï¼ˆ`evaluate.py`ï¼‰
   - çŸ¥è¯†åº“æ£€ç´¢å’Œåˆå¹¶ï¼ˆ`merge.py`ï¼Œç¬¬ 2 æ¬¡è¿­ä»£å¼€å§‹ï¼‰
4. âœ… æœ€ç»ˆè¯„ä¼°ï¼ˆtop1, top3, top5ï¼‰

**è¿è¡Œæ—¶é—´**ï¼š

- å•ä¸ªä»£ç ä¼˜åŒ–ï¼šçº¦ 5-15 åˆ†é’Ÿï¼ˆå–å†³äºå€™é€‰æ•°é‡å’Œè¿­ä»£æ¬¡æ•°ï¼‰
- æ‰¹é‡ä¼˜åŒ–ï¼ˆ100 ä¸ªä»£ç ï¼‰ï¼šçº¦ 2-4 å°æ—¶

#### æ­¥éª¤ 3: æŸ¥çœ‹ç»“æœ

ä¼˜åŒ–å®Œæˆåï¼Œç»“æœä¿å­˜åœ¨ `output/riscv/riscv_optimization/` ç›®å½•ï¼š

```bash
# æŸ¥çœ‹æœ€ç»ˆç»“æœ
cat output/riscv/riscv_optimization/results.jsonl

# æŸ¥çœ‹æœ€åä¸€æ¬¡è¿­ä»£çš„è¯„ä¼°æŠ¥å‘Š
cat output/riscv/riscv_optimization/4/test_execution_*.report
```

### å®Œæ•´ä½¿ç”¨æµç¨‹

#### åœºæ™¯ 1: å¿«é€Ÿæµ‹è¯•ï¼ˆå¼€å‘é˜¶æ®µï¼‰

é€‚ç”¨äºå¿«é€ŸéªŒè¯æ¡†æ¶åŠŸèƒ½ï¼Œä½¿ç”¨è¾ƒå°‘å€™é€‰å’Œè¿­ä»£æ¬¡æ•°ï¼š

```bash
bash run_riscv.sh \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu \
    --generation_number 3 \
    --iterations 2 \
    --retrieval_method bm25  # ä½¿ç”¨ BM25 åŠ å¿«é€Ÿåº¦
```

**ç‰¹ç‚¹**ï¼š

- âš¡ é€Ÿåº¦å¿«ï¼šçº¦ 2-5 åˆ†é’Ÿå®Œæˆ
- ğŸ¯ é€‚åˆï¼šåŠŸèƒ½éªŒè¯ã€å¿«é€Ÿæµ‹è¯•

#### åœºæ™¯ 2: æ ‡å‡†ä¼˜åŒ–ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

é€‚ç”¨äºå®é™…é¡¹ç›®ä¼˜åŒ–ï¼Œå¹³è¡¡é€Ÿåº¦å’Œæ•ˆæœï¼š

```bash
bash run_riscv.sh \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu \
    --model_name gemini \
    --generation_number 5 \
    --iterations 4 \
    --retrieval_method hybrid \
    --vector_index_path ../processed_data/riscv/faiss_index.bin
```

#### åœºæ™¯ 3: å®Œæ•´åŸºå‡†æµ‹è¯•è¯„ä¼° (RVV-Bench / VecIntrinBench)

é€‚ç”¨äºè¿è¡Œå®Œæ•´çš„åŸºå‡†æµ‹è¯•å¥—ä»¶ï¼ˆåŒ…å«æ•°æ®å‡†å¤‡ã€ç”Ÿæˆå’Œè¯„ä¼°ï¼‰ï¼š

**RVV-Bench å®Œæ•´è¯„ä¼°**:

```bash
# åœ¨ Docker ç¯å¢ƒä¸­æˆ– sbllm_repo ç›®å½•ä¸‹
bash run_rvv_full_eval.sh
```

**VecIntrinBench å®Œæ•´è¯„ä¼°**:

```bash
# åœ¨ Docker ç¯å¢ƒä¸­æˆ– sbllm_repo ç›®å½•ä¸‹
bash run_vecintrin_full_eval.sh
```

**æ‰€æœ‰åŸºå‡†æµ‹è¯•å®Œæ•´è¯„ä¼° (ä¸€é”®è¿è¡Œ)**:

```bash
# Linux / Docker
bash run_full_benchmarks.sh

# Windows (Host)
.\run_full_benchmarks.ps1
```

**ç‰¹ç‚¹**ï¼š

- âš–ï¸ å¹³è¡¡ï¼šé€Ÿåº¦ä¸æ•ˆæœçš„æœ€ä½³å¹³è¡¡
- ğŸ¯ é€‚åˆï¼šç”Ÿäº§ç¯å¢ƒã€å®é™…é¡¹ç›®

#### åœºæ™¯ 3: æ·±åº¦ä¼˜åŒ–ï¼ˆç ”ç©¶åœºæ™¯ï¼‰

é€‚ç”¨äºè¿½æ±‚æè‡´ä¼˜åŒ–æ•ˆæœï¼Œä½¿ç”¨æ›´å¤šå€™é€‰å’Œè¿­ä»£ï¼š

```bash
bash run_riscv.sh \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu \
    --model_name gpt4 \
    --generation_number 8 \
    --iterations 6 \
    --retrieval_method hybrid \
    --hybrid_alpha 0.6 \
    --vector_index_path ../processed_data/riscv/faiss_index.bin
```

**ç‰¹ç‚¹**ï¼š

- ğŸ”¬ æ·±åº¦ï¼šæ¢ç´¢æ›´å¤šä¼˜åŒ–å¯èƒ½æ€§
- ğŸ¯ é€‚åˆï¼šç ”ç©¶ã€è®ºæ–‡å®éªŒã€å…³é”®ä»£ç ä¼˜åŒ–

### æ‰‹åŠ¨è¿è¡Œï¼ˆé«˜çº§ç”¨æˆ·ï¼‰

å¦‚æœéœ€è¦æ‰‹åŠ¨æ§åˆ¶æ¯ä¸ªæ­¥éª¤ï¼Œæˆ–è¿›è¡Œè°ƒè¯•ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹å‘½ä»¤ï¼š

#### å®Œæ•´æ‰‹åŠ¨æµç¨‹

**æ­¥éª¤ 1: åˆå§‹åŒ–ç»“æœ**

```bash
cd sbllm
python sbllm/initial.py --model_name chatgpt --lang riscv
```

**æ­¥éª¤ 2: ç¬¬ä¸€æ¬¡è¿­ä»£ - ç”Ÿæˆä¼˜åŒ–å€™é€‰**

```bash
cd sbllm/sbllm
python evol_query.py \
    --mode riscv_optimization \
    --model_name chatgpt \
    --lang riscv \
    --generation_path ../output \
    --baseline_data_path ../processed_data/riscv/test.jsonl \
    --iteration 0 \
    --generation_number 5 \
    --riscv_mode
```

**æ­¥éª¤ 3: è¯„ä¼°å€™é€‰ä»£ç ï¼ˆQEMUï¼‰**

```bash
python evaluate.py \
    --mode riscv_optimization \
    --lang riscv \
    --output_path ../output/riscv \
    --model_name chatgpt \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu \
    --test_case_path ../processed_data/riscv/test_cases \
    --process_number 8 \
    --riscv_mode
```

**æ­¥éª¤ 4: çŸ¥è¯†åº“æ£€ç´¢å’Œåˆå¹¶ï¼ˆç¬¬ 2 æ¬¡è¿­ä»£å¼€å§‹ï¼‰**

```bash
python merge.py \
    --lang riscv \
    --mode riscv_optimization \
    --iteration 1 \
    --model_name chatgpt \
    --generation_path ../output \
    --training_data_path ../processed_data/riscv/train.jsonl \
    --retrieval_method hybrid \
    --hybrid_alpha 0.5 \
    --embedding_model all-MiniLM-L6-v2
```

**æ­¥éª¤ 5: ç»§ç»­è¿­ä»£ï¼ˆé‡å¤æ­¥éª¤ 2-4ï¼Œiteration é€’å¢ï¼‰**

```bash
# ç¬¬ 2 æ¬¡è¿­ä»£
python evol_query.py --iteration 1 ...
python evaluate.py --mode 1 ...
python merge.py --iteration 2 ...

# ç¬¬ 3 æ¬¡è¿­ä»£
python evol_query.py --iteration 2 ...
python evaluate.py --mode 2 ...
python merge.py --iteration 3 ...
```

### ä½¿ç”¨ç¤ºä¾‹

#### ç¤ºä¾‹ 1: ä¼˜åŒ–å•ä¸ª RISC-V æ±‡ç¼–å‡½æ•°

**è¾“å…¥ä»£ç **ï¼ˆ`test.jsonl`ï¼‰ï¼š

```json
{
    "idx": 0,
    "query": "# è®¡ç®—æ•°ç»„å…ƒç´ ä¹‹å’Œ\n# ä¼˜åŒ–æ–¹å‘ï¼šå‡å°‘å†…å­˜è®¿é—®\n.text\n.global sum_array\nsum_array:\n    li t0, 0\n    li t1, 0\nloop:\n    beq t1, a1, done\n    lw t2, 0(a0)\n    add t0, t0, t2\n    addi a0, a0, 4\n    addi t1, t1, 1\n    j loop\ndone:\n    mv a0, t0\n    ret",
    "input": "10\n1 2 3 4 5 6 7 8 9 10"
}
```

**è¿è¡Œä¼˜åŒ–**ï¼š

```bash
bash run_riscv.sh \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu
```

**è¾“å‡ºç»“æœ**ï¼š

- ä¼˜åŒ–åçš„ä»£ç ï¼ˆåŠŸèƒ½æ­£ç¡®ï¼Œæ€§èƒ½æå‡ï¼‰
- æ‰§è¡Œæ—¶é—´å¯¹æ¯”
- ä»£ç ä½“ç§¯å¯¹æ¯”

#### ç¤ºä¾‹ 2: æ‰¹é‡ä¼˜åŒ–å¤šä¸ªä»£ç 

å‡†å¤‡åŒ…å«å¤šä¸ªä»£ç çš„ `test.jsonl` æ–‡ä»¶ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨å¤„ç†æ‰€æœ‰ä»£ç ã€‚

#### ç¤ºä¾‹ 3: ä½¿ç”¨ä¸åŒçš„ LLM æ¨¡å‹

```bash
# ä½¿ç”¨ Gemini
bash run_riscv.sh \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu \
    --model_name gemini

# ä½¿ç”¨ GPT-4
bash run_riscv.sh \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu \
    --model_name gpt4
```

### è¿è¡Œè„šæœ¬å‚æ•°è¯´æ˜

#### run_riscv.sh å‚æ•°

| å‚æ•° | è¯´æ˜ | å¿…éœ€ | é»˜è®¤å€¼ |
|------|------|------|--------|
| `--qemu_path` | QEMU å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ | âœ… | - |
| `--riscv_gcc_toolchain_path` | RISC-V GCC å·¥å…·é“¾è·¯å¾„ | âœ… | - |
| `--model_name` | LLM æ¨¡å‹åç§° | âŒ | `chatgpt` |
| `--generation_number` | æ¯æ¬¡ç”Ÿæˆçš„å€™é€‰æ•°é‡ | âŒ | `5` |
| `--beam_number` | beam æœç´¢æ•°é‡ | âŒ | `3` |
| `--iterations` | è¿­ä»£æ¬¡æ•° | âŒ | `4` |
| `--data_dir` | æ•°æ®ç›®å½•è·¯å¾„ | âŒ | `../processed_data/riscv` |
| `--output_dir` | è¾“å‡ºç›®å½•è·¯å¾„ | âŒ | `../output/riscv` |
| `--retrieval_method` | æ£€ç´¢æ–¹æ³•ï¼ˆbm25/vector/hybridï¼‰ | âŒ | `hybrid` |
| `--vector_index_path` | å‘é‡ç´¢å¼•æ–‡ä»¶è·¯å¾„ | âŒ | - |

**æ”¯æŒçš„æ¨¡å‹**ï¼š`chatgpt`, `gpt4`, `gemini`, `deepseek`, `codellama`

**æ£€ç´¢æ–¹æ³•**ï¼š

- `bm25` - ä»…ä½¿ç”¨ BM25 å…³é”®è¯æ£€ç´¢
- `vector` - ä»…ä½¿ç”¨å‘é‡è¯­ä¹‰æ£€ç´¢
- `hybrid` - æ··åˆæ£€ç´¢ï¼ˆBM25 + å‘é‡ï¼Œæ¨èï¼‰

#### validate_riscv_setup.py å‚æ•°

| å‚æ•° | è¯´æ˜ | å¿…éœ€ | é»˜è®¤å€¼ |
|------|------|------|--------|
| `--qemu_path` | QEMU å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ | âœ… | - |
| `--riscv_gcc_toolchain_path` | RISC-V GCC å·¥å…·é“¾è·¯å¾„ | âœ… | - |
| `--data_dir` | æ•°æ®ç›®å½•è·¯å¾„ | âŒ | `../processed_data/riscv` |
| `--output_dir` | è¾“å‡ºç›®å½•è·¯å¾„ | âŒ | `../output/riscv` |

## æ ¸å¿ƒæ¨¡å—è¯´æ˜

### æ¨¡å—ä¸€ï¼šç”Ÿæˆä¼˜åŒ–å€™é€‰é›†ï¼ˆevol_query.pyï¼‰

**åŠŸèƒ½**ï¼šåœ¨ç¬¬ä¸€æ¬¡è¿­ä»£æ—¶ï¼Œåˆ†æä»£ç æ³¨é‡Šå¹¶ç”Ÿæˆä¼˜åŒ–å»ºè®®ï¼Œç„¶ååŸºäºå»ºè®®ç”Ÿæˆå¤šä¸ªä¼˜åŒ–å€™é€‰ã€‚

**å…³é”®å‡½æ•°**ï¼š

- `generate_review_comments(code, cfg)`: ç”Ÿæˆä¼˜åŒ–å»ºè®®
- `read_file(cfg)`: åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£æ—¶é›†æˆ review comments ç”Ÿæˆæµç¨‹

**å·¥ä½œæµç¨‹**ï¼š

1. è°ƒç”¨ `generate_review_comments()` åˆ†æä»£ç æ³¨é‡Š
2. ä½¿ç”¨ `_PROMPT_FOR_REVIEW` prompt æ¨¡æ¿
3. å°† review comments ä¸åŸå§‹ä»£ç ç»“åˆï¼Œä½¿ç”¨ `_PROMPT_FOR_CANDIDATES` ç”Ÿæˆå€™é€‰ä»£ç 

### æ¨¡å—äºŒï¼šæ ·æœ¬ç­›é€‰ï¼ˆqemu_evaluator.py + execution.pyï¼‰

**åŠŸèƒ½**ï¼šä½¿ç”¨ QEMU ä»¿çœŸç¯å¢ƒè¯„ä¼°å€™é€‰ä»£ç çš„æ€§èƒ½å’Œæ­£ç¡®æ€§ã€‚

**å…³é”®ç±»**ï¼š

- `QEMURISCVEvaluator`: QEMU RISC-V è¯„ä¼°å™¨

**å…³é”®æ–¹æ³•**ï¼š

- `compile_to_riscv_binary()`: ç¼–è¯‘ RISC-V ä»£ç ä¸ºäºŒè¿›åˆ¶ï¼ˆæ”¯æŒç¼–è¯‘ç¼“å­˜ï¼‰
- `run_and_measure()`: è¿è¡Œå¹¶æµ‹é‡æ‰§è¡Œæ—¶é—´å’Œä»£ç å¤§å°ï¼ŒéªŒè¯åŠŸèƒ½æ­£ç¡®æ€§
- `evaluate_candidates()`: æ‰¹é‡è¯„ä¼°å€™é€‰ä»£ç 
- `evaluate_candidates_parallel()`: å¹¶è¡Œè¯„ä¼°å¤šä¸ªå€™é€‰ä»£ç ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰

**åŠŸèƒ½æ­£ç¡®æ€§æ£€æŸ¥**ï¼š

- âœ… **è¾“å‡ºæ¯”è¾ƒ**ï¼šæ¯”è¾ƒä¼˜åŒ–ä»£ç ä¸åŸå§‹ä»£ç çš„è¾“å‡ºç»“æœ
- âœ… **æ•°å€¼å®¹å·®**ï¼šæ”¯æŒæµ®ç‚¹æ•°å®¹å·®æ¯”è¾ƒï¼ˆé»˜è®¤ 1e-6ï¼‰
- âœ… **è¿”å›ç æ£€æŸ¥**ï¼šæ£€æŸ¥ç¨‹åºæ‰§è¡Œè¿”å›ç 
- âœ… **å¤šè½®éªŒè¯**ï¼šå¤šæ¬¡è¿è¡Œå–æœ€ç¨³å®šçš„è¾“å‡º

**è¯„ä¼°æŒ‡æ ‡**ï¼š

- åŠŸèƒ½æ­£ç¡®æ€§ï¼ˆis_correctï¼‰- é€šè¿‡è¾“å‡ºæ¯”è¾ƒå’Œè¿”å›ç éªŒè¯
- æ‰§è¡Œæ—¶é—´ï¼ˆexecution_timeï¼‰- å¤šæ¬¡è¿è¡Œçš„å¹³å‡å€¼
- ä»£ç å¤§å°ï¼ˆcode_sizeï¼‰- ä½¿ç”¨ size æˆ– objdump è·å–
- åŠ é€Ÿæ¯”ï¼ˆspeedup_ratio = 1 - new_time/old_timeï¼‰
- ä½“ç§¯ç¼©å‡ç‡ï¼ˆsize_reduction_ratioï¼‰

**æ€§èƒ½ä¼˜åŒ–ç‰¹æ€§**ï¼š

- âœ… **ç¼–è¯‘ç¼“å­˜**ï¼šåŸºäºä»£ç å“ˆå¸Œçš„ç¼–è¯‘ç»“æœç¼“å­˜ï¼Œé¿å…é‡å¤ç¼–è¯‘
- âœ… **å¹¶è¡Œè¯„ä¼°**ï¼šä½¿ç”¨çº¿ç¨‹æ± å¹¶è¡Œè¯„ä¼°å¤šä¸ªå€™é€‰ä»£ç 
- âœ… **æ™ºèƒ½ç¼“å­˜**ï¼šè‡ªåŠ¨ç¼“å­˜ç¼–è¯‘ç»“æœï¼Œæ˜¾è‘—æå‡è¯„ä¼°é€Ÿåº¦

### æ¨¡å—ä¸‰ï¼šçŸ¥è¯†åº“æ¨¡æ¿æ£€ç´¢ï¼ˆmerge.pyï¼‰

**åŠŸèƒ½**ï¼šä»ä¼˜åŒ–è¡¥ä¸çŸ¥è¯†åº“ä¸­æ£€ç´¢ Similar Pattern å’Œ Different Patternã€‚

**æ£€ç´¢ç­–ç•¥**ï¼š

- **BM25 æ£€ç´¢**ï¼šåŸºäºå…³é”®è¯åŒ¹é…
- **å‘é‡æ£€ç´¢**ï¼šåŸºäºè¯­ä¹‰ç›¸ä¼¼åº¦ï¼ˆä½¿ç”¨ sentence-transformersï¼‰
- **æ··åˆæ£€ç´¢**ï¼šèåˆ BM25 å’Œå‘é‡æ£€ç´¢ç»“æœ

**å…³é”®ä¿®æ”¹**ï¼š

- `main()`: åŠ è½½ FAISS å‘é‡ç´¢å¼•å’Œ embedding æ¨¡å‹
- `process()`: å®ç°æ··åˆæ£€ç´¢é€»è¾‘ï¼Œæ£€ç´¢ Similar å’Œ Different Pattern
- åœ¨ç»“æœä¸­å­˜å‚¨æ£€ç´¢æ¥æºä¿¡æ¯

### æ¨¡å—å››ï¼šé—ä¼ è¿­ä»£ä¼˜åŒ–ï¼ˆevol_query.pyï¼‰

**åŠŸèƒ½**ï¼šä½¿ç”¨é—ä¼ ç®—æ³•è¿­ä»£ä¼˜åŒ–ä»£ç ï¼Œç»“åˆ Similar å’Œ Different Patternã€‚

**å…³é”®å‡½æ•°**ï¼š

- `prompt_construction()`: æ„å»ºè¿­ä»£ä¼˜åŒ–çš„ prompt

**Prompt æ¨¡æ¿**ï¼š

- `_PROMPT_FOR_RISCV_EVOLUTION`: é—ä¼ è¿­ä»£ä¼˜åŒ–çš„ prompt

**å·¥ä½œæµç¨‹**ï¼š

1. åˆ†æåŸå§‹ä»£ç å’Œå½“å‰ä¼˜åŒ–ç‰ˆæœ¬
2. è¯†åˆ«æœªä½¿ç”¨çš„ä¼˜åŒ–æœºä¼šï¼ˆMutationï¼‰
3. ç»“åˆ Similar å’Œ Different Pattern ç”Ÿæˆæ–°ç‰ˆæœ¬
4. ä½¿ç”¨ QEMU è¯„ä¼°æ–°ç‰ˆæœ¬
5. å¦‚æœæå‡æ˜¾è‘—ï¼Œç»§ç»­è¿­ä»£ï¼›å¦åˆ™æ”¶æ•›

## æ•°æ®æ ¼å¼è¯´æ˜

### çŸ¥è¯†åº“æ•°æ®æ ¼å¼ï¼ˆtrain.jsonlï¼‰

```json
{
    "id": 1,
    "source": "riscv-optimization-patches",
    "optimization_type": "Conditional Branch Optimization",
    "optimization_description": "ä¼˜åŒ–æ¡ä»¶åˆ†æ”¯ï¼Œå‡å°‘è·³è½¬å¼€é”€",
    "original_code": "åŸå§‹ RISC-V ä»£ç ",
    "optimized_code": "ä¼˜åŒ–åçš„ RISC-V ä»£ç ",
    "query_abs": "æŠ½è±¡åŒ–åçš„æŸ¥è¯¢ä»£ç ï¼ˆtokenizedï¼‰",
    "edit_code_abs": "åˆ é™¤éƒ¨åˆ†ï¼ˆdsï¼‰çš„æŠ½è±¡è¡¨ç¤º",
    "edit_opt_abs": "æ–°å¢éƒ¨åˆ†ï¼ˆdfï¼‰çš„æŠ½è±¡è¡¨ç¤º",
    "text_representation": "ç”¨äºå‘é‡æ£€ç´¢çš„æ–‡æœ¬è¡¨ç¤º"
}
```

### æµ‹è¯•æ•°æ®æ ¼å¼ï¼ˆtest.jsonlï¼‰

```json
{
    "idx": 0,
    "query": "å¾…ä¼˜åŒ–çš„ RISC-V ä»£ç ï¼ˆåŒ…å«æ³¨é‡Šï¼‰",
    "reference": "å‚è€ƒä¼˜åŒ–ä»£ç ï¼ˆå¯é€‰ï¼‰",
    "input": "æµ‹è¯•è¾“å…¥ï¼ˆå¯é€‰ï¼‰"
}
```

### æ‰§è¡ŒæŠ¥å‘Šæ ¼å¼ï¼ˆtest_execution_*.reportï¼‰

```json
{
    "code_v0_no_empty_lines": "åŸå§‹ä»£ç ",
    "code_v1_no_empty_lines": "å‚è€ƒä»£ç ",
    "input_time_mean": 1.23,
    "reference_time_mean": 0.98,
    "model_generated_potentially_faster_code_col": "æœ€ä½³å€™é€‰ä»£ç ",
    "model_generated_potentially_faster_code_col_acc": 1,
    "model_generated_potentially_faster_code_col_time_mean": 0.85,
    "model_generated_potentially_faster_code_col_0": "å€™é€‰ä»£ç  0",
    "model_generated_potentially_faster_code_col_0_acc": 1,
    "model_generated_potentially_faster_code_col_0_time_mean": 0.90
}
```

## å·¥ä½œæµç¨‹

### è‡ªåŠ¨åŒ–æµç¨‹ï¼ˆä½¿ç”¨ run_riscv.shï¼‰

```
1. ç¯å¢ƒéªŒè¯
   â””â”€ validate_riscv_setup.py
      â”œâ”€ æ£€æŸ¥ QEMU
      â”œâ”€ æ£€æŸ¥å·¥å…·é“¾
      â”œâ”€ æ£€æŸ¥æ•°æ®æ–‡ä»¶
      â””â”€ æ£€æŸ¥ API å¯†é’¥

2. åˆå§‹åŒ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
   â””â”€ initial.py
      â””â”€ ç”Ÿæˆåˆå§‹ç»“æœæ–‡ä»¶

3. è¿­ä»£ä¼˜åŒ–ï¼ˆå¾ªç¯ N æ¬¡ï¼‰
   â”œâ”€ evol_query.py
   â”‚  â””â”€ ç”Ÿæˆä¼˜åŒ–å€™é€‰ï¼ˆç¬¬ä¸€æ¬¡è¿­ä»£åŒ…å«æ³¨é‡Šåˆ†æï¼‰
   â”œâ”€ evaluate.py
   â”‚  â””â”€ QEMU è¯„ä¼°å€™é€‰ä»£ç 
   â””â”€ merge.py
      â””â”€ çŸ¥è¯†åº“æ£€ç´¢å’Œåˆå¹¶ï¼ˆç¬¬ 2 æ¬¡è¿­ä»£å¼€å§‹ï¼‰

4. æœ€ç»ˆè¯„ä¼°
   â””â”€ evaluate.py
      â”œâ”€ top1 è¯„ä¼°
      â”œâ”€ top3 è¯„ä¼°
      â””â”€ top5 è¯„ä¼°
```

### è¾“å‡ºç»“æ„

```
output/riscv/riscv_optimization/
â”œâ”€â”€ results.jsonl              # æœ€ç»ˆç»“æœ
â”œâ”€â”€ 0/                          # åˆå§‹è¿­ä»£
â”œâ”€â”€ 1/                          # ç¬¬ 1 æ¬¡è¿­ä»£
â”‚   â”œâ”€â”€ prediction_*.jsonl
â”‚   â”œâ”€â”€ test_execution_*.report
â”‚   â””â”€â”€ qemu_temp/              # QEMU ä¸´æ—¶æ–‡ä»¶
â”œâ”€â”€ 2/                          # ç¬¬ 2 æ¬¡è¿­ä»£
â”œâ”€â”€ ...
â””â”€â”€ 4/                          # æœ€ç»ˆè¿­ä»£
    â”œâ”€â”€ top1/
    â”œâ”€â”€ top3/
    â””â”€â”€ top5/
```

## è¾“å‡ºç»“æœè¯´æ˜

### results.jsonl æ ¼å¼

```json
{
    "idx": 0,
    "query": "åŸå§‹ä»£ç ",
    "reference": "å‚è€ƒä»£ç ",
    "stop": 0,
    "best_result": {
        "code": "æœ€ä½³ä¼˜åŒ–ä»£ç ",
        "acc": 1,
        "time": 0.85,
        "input_time": 1.23,
        "reference_time": 0.98
    },
    "best_candidates": [
        {
            "code": "å€™é€‰ä»£ç ",
            "acc": 1,
            "time": 0.85,
            "input_time": 1.23,
            "content": "å®Œæ•´å†…å®¹"
        }
    ],
    "pattern": [
        "Similar Pattern",
        "Different Pattern"
    ],
    "retrieval": {
        "query": "æŸ¥è¯¢æ–‡æœ¬",
        "selected_ids": [1, 2],
        "method": "hybrid"
    }
}
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. QEMU è·¯å¾„é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š

```
FileNotFoundError: QEMU path not found: /usr/bin/qemu-riscv64
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# 1. æ£€æŸ¥ QEMU æ˜¯å¦å®‰è£…
which qemu-riscv64

# 2. å¦‚æœæœªå®‰è£…ï¼Œå®‰è£… QEMU
sudo apt-get install qemu-user-riscv64

# 3. å¦‚æœå·²å®‰è£…ä½†è·¯å¾„ä¸åŒï¼Œä½¿ç”¨å®Œæ•´è·¯å¾„
bash run_riscv.sh \
    --qemu_path $(which qemu-riscv64) \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu
```

#### 2. RISC-V GCC å·¥å…·é“¾é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š

```
FileNotFoundError: RISC-V GCC path not found: /opt/riscv64-unknown-linux-gnu/bin/riscv64-unknown-linux-gnu-gcc
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# 1. ç¡®è®¤å·¥å…·é“¾å·²å®‰è£…
ls /opt/riscv64-unknown-linux-gnu/bin/

# 2. ä½¿ç”¨å·¥å…·é“¾æ ¹ç›®å½•è·¯å¾„ï¼ˆä¸æ˜¯ bin ç›®å½•ï¼‰
# æ­£ç¡®ï¼š--riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu
# é”™è¯¯ï¼š--riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu/bin

# 3. å¦‚æœè·¯å¾„ä¸åŒï¼Œä½¿ç”¨å®é™…è·¯å¾„
bash run_riscv.sh \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /path/to/your/riscv-toolchain
```

#### 3. æ•°æ®æ–‡ä»¶ç¼ºå¤±æˆ–æ ¼å¼é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š

```
FileNotFoundError: Test data file not found: ../processed_data/riscv/test.jsonl
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# 1. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la processed_data/riscv/test.jsonl

# 2. æ£€æŸ¥æ–‡ä»¶æ ¼å¼ï¼ˆåº”è¯¥æ˜¯ JSONLï¼Œæ¯è¡Œä¸€ä¸ª JSON å¯¹è±¡ï¼‰
head -n 1 processed_data/riscv/test.jsonl

# 3. éªŒè¯å¿…éœ€å­—æ®µ
python -c "import jsonlines; f=jsonlines.open('processed_data/riscv/test.jsonl'); print(next(f))"
```

**æ•°æ®æ ¼å¼è¦æ±‚**ï¼š

- æ–‡ä»¶å¿…é¡»æ˜¯ JSONL æ ¼å¼ï¼ˆæ¯è¡Œä¸€ä¸ª JSON å¯¹è±¡ï¼‰
- æµ‹è¯•æ•°æ®å¿…é¡»åŒ…å« `idx` å’Œ `query` å­—æ®µ
- è®­ç»ƒæ•°æ®å¿…é¡»åŒ…å« `id`, `original_code`, `optimized_code` å­—æ®µ

#### 4. API å¯†é’¥æœªé…ç½®

**è­¦å‘Šä¿¡æ¯**ï¼š

```
âš  æ£€æµ‹åˆ°å ä½ç¬¦ API å¯†é’¥ï¼Œè¯·ç¡®ä¿å·²é…ç½®çœŸå®çš„ API å¯†é’¥
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# 1. ç¼–è¾‘ evol_query.py
vim sbllm/sbllm/evol_query.py

# 2. æ‰¾åˆ°å¹¶æ›¿æ¢å ä½ç¬¦
# å°† "xxxxxxxxxxxxxxxxxxxx" æ›¿æ¢ä¸ºä½ çš„çœŸå® API å¯†é’¥

# 3. ä¿å­˜æ–‡ä»¶åé‡æ–°è¿è¡Œ
```

**API å¯†é’¥è·å–**ï¼š

- OpenAI: <https://platform.openai.com/api-keys>
- Gemini: <https://makersuite.google.com/app/apikey>
- DeepSeek: <https://platform.deepseek.com/api_keys>
- CodeLlama: <https://deepinfra.com/>

#### 5. Python ä¾èµ–ç¼ºå¤±

**é”™è¯¯ä¿¡æ¯**ï¼š

```
âœ— Python åŒ…ç¼ºå¤±: faiss-cpu
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# å®‰è£…æ‰€æœ‰ä¾èµ–
pip install -r requirement.txt

# å¦‚æœæŸä¸ªåŒ…å®‰è£…å¤±è´¥ï¼Œå•ç‹¬å®‰è£…
pip install faiss-cpu==1.7.4
pip install sentence-transformers==2.2.2
```

#### 6. ç¼–è¯‘å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š

```
Assembly failed: error: invalid instruction
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# 1. æ£€æŸ¥ä»£ç æ ¼å¼
# ç¡®ä¿æ˜¯æœ‰æ•ˆçš„ RISC-V æ±‡ç¼–æˆ– C ä»£ç 

# 2. æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
# æ£€æŸ¥æ—¥å¿—æ–‡ä»¶æˆ–æ ‡å‡†é”™è¯¯è¾“å‡º

# 3. éªŒè¯ä»£ç è¯­æ³•
# ä½¿ç”¨ riscv64-unknown-linux-gnu-gcc æ‰‹åŠ¨ç¼–è¯‘æµ‹è¯•
```

#### 7. å‘é‡æ£€ç´¢å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š

```
Failed to load embedding model: all-MiniLM-L6-v2
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```bash
# 1. æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ˆé¦–æ¬¡ä½¿ç”¨éœ€è¦ä¸‹è½½æ¨¡å‹ï¼‰
ping huggingface.co

# 2. æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹
python -c "from sentence_transformers import SentenceTransformer; SentenceTransformer('all-MiniLM-L6-v2')"

# 3. ä½¿ç”¨å…¶ä»–æ¨¡å‹
bash run_riscv.sh \
    --qemu_path /usr/bin/qemu-riscv64 \
    --riscv_gcc_toolchain_path /opt/riscv64-unknown-linux-gnu \
    --embedding_model all-mpnet-base-v2
```

#### 8. å†…å­˜ä¸è¶³

**é”™è¯¯ä¿¡æ¯**ï¼š

```
MemoryError: Unable to allocate array
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

- å‡å°‘å¹¶è¡Œè¿›ç¨‹æ•°ï¼š`--process_number 4`
- å‡å°‘å€™é€‰æ•°é‡ï¼š`--generation_number 3`
- ä½¿ç”¨ BM25 æ£€ç´¢ï¼ˆä¸ä½¿ç”¨å‘é‡æ£€ç´¢ï¼‰ï¼š`--retrieval_method bm25`

#### 9. æ‰§è¡Œè¶…æ—¶

**é”™è¯¯ä¿¡æ¯**ï¼š

```
Execution timeout for candidate_0.bin
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

- æ£€æŸ¥ä»£ç æ˜¯å¦æœ‰æ— é™å¾ªç¯
- å¢åŠ è¶…æ—¶æ—¶é—´ï¼ˆä¿®æ”¹ `qemu_evaluator.py` ä¸­çš„ `timeout=10`ï¼‰
- æ£€æŸ¥è¾“å…¥æ•°æ®æ˜¯å¦è¿‡å¤§

### è°ƒè¯•æŠ€å·§

#### 1. å¯ç”¨è¯¦ç»†æ—¥å¿—

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

#### 2. æ£€æŸ¥ä¸­é—´ç»“æœ

```bash
# æŸ¥çœ‹ç”Ÿæˆçš„å€™é€‰ä»£ç 
cat output/riscv/riscv_optimization/0/prediction_*.jsonl

# æŸ¥çœ‹è¯„ä¼°æŠ¥å‘Š
cat output/riscv/riscv_optimization/0/test_execution_*.report
```

#### 3. å•ç‹¬æµ‹è¯•ç»„ä»¶

```python
# æµ‹è¯• QEMU è¯„ä¼°å™¨
from sbllm.qemu_evaluator import QEMURISCVEvaluator

evaluator = QEMURISCVEvaluator(
    qemu_path="/usr/bin/qemu-riscv64",
    riscv_gcc_toolchain_path="/opt/riscv64-unknown-linux-gnu"
)

# æµ‹è¯•ç¼–è¯‘
success = evaluator.compile_to_riscv_binary(code, "test.bin")
print(f"ç¼–è¯‘æˆåŠŸ: {success}")

# æµ‹è¯•è¿è¡Œ
time, size, correct, output = evaluator.run_and_measure("test.bin")
print(f"æ‰§è¡Œæ—¶é—´: {time}s, æ­£ç¡®æ€§: {correct}")
```

## âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### è¯„ä¼°æ€§èƒ½ä¼˜åŒ–

#### 1. ç¼–è¯‘ç¼“å­˜ï¼ˆé»˜è®¤å¯ç”¨ï¼‰

**åŠŸèƒ½**ï¼šåŸºäºä»£ç å“ˆå¸Œçš„ç¼–è¯‘ç»“æœç¼“å­˜ï¼Œé¿å…é‡å¤ç¼–è¯‘ç›¸åŒä»£ç ã€‚

**æ€§èƒ½æå‡**ï¼š50-80%ï¼ˆé‡å¤è¯„ä¼°åœºæ™¯ï¼‰

**ä½¿ç”¨æ–¹å¼**ï¼š

```python
evaluator = QEMURISCVEvaluator(
    qemu_path=qemu_path,
    riscv_gcc_toolchain_path=toolchain_path,
    enable_cache=True  # é»˜è®¤å¯ç”¨
)
```

#### 2. å¹¶è¡Œè¯„ä¼°

**åŠŸèƒ½**ï¼šä½¿ç”¨çº¿ç¨‹æ± å¹¶è¡Œè¯„ä¼°å¤šä¸ªå€™é€‰ä»£ç ã€‚

**æ€§èƒ½æå‡**ï¼š2-4 å€ï¼ˆå–å†³äº CPU æ ¸å¿ƒæ•°ï¼‰

**ä½¿ç”¨æ–¹å¼**ï¼š

```python
evaluator = QEMURISCVEvaluator(
    qemu_path=qemu_path,
    riscv_gcc_toolchain_path=toolchain_path,
    max_workers=4  # å»ºè®®è®¾ç½®ä¸º CPU æ ¸å¿ƒæ•°
)

# ä½¿ç”¨å¹¶è¡Œè¯„ä¼°æ–¹æ³•
results = evaluator.evaluate_candidates_parallel(
    original_code=original_code,
    candidate_codes=candidate_codes,
    input_data=input_data,
    reference_output=reference_output
)
```

#### 3. å¹¶è¡Œè¿›ç¨‹æ•°é…ç½®

åœ¨ `evaluate.py` ä¸­è°ƒæ•´ `--process_number` å‚æ•°ï¼š

```bash
python evaluate.py \
    --process_number 8 \  # æ ¹æ® CPU æ ¸å¿ƒæ•°è°ƒæ•´
    ...
```

**å»ºè®®**ï¼šè®¾ç½®ä¸º `CPU æ ¸å¿ƒæ•° - 1`ï¼ˆä¿ç•™ä¸€ä¸ªæ ¸å¿ƒç»™ç³»ç»Ÿï¼‰

### æ£€ç´¢æ€§èƒ½ä¼˜åŒ–

#### 1. å‘é‡ç´¢å¼•ç¼“å­˜

**åŠŸèƒ½**ï¼šä½¿ç”¨é¢„æ„å»ºçš„ FAISS å‘é‡ç´¢å¼•ï¼Œé¿å…æ¯æ¬¡é‡æ–°æ„å»ºã€‚

**æ€§èƒ½æå‡**ï¼šé¦–æ¬¡æ„å»ºåï¼Œåç»­åŠ è½½å¯èŠ‚çœ 90%+ æ—¶é—´

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
# é¦–æ¬¡è¿è¡Œï¼šè‡ªåŠ¨æ„å»ºå¹¶ä¿å­˜ç´¢å¼•
python merge.py \
    --training_data_path ./processed_data/riscv/train.jsonl \
    --retrieval_method hybrid \
    --vector_index_path ./processed_data/riscv/faiss_index.bin

# åç»­è¿è¡Œï¼šç›´æ¥åŠ è½½ç´¢å¼•
python merge.py \
    --training_data_path ./processed_data/riscv/train.jsonl \
    --retrieval_method hybrid \
    --vector_index_path ./processed_data/riscv/faiss_index.bin  # ä½¿ç”¨å·²æ„å»ºçš„ç´¢å¼•
```

#### 2. æ£€ç´¢ç­–ç•¥é€‰æ‹©

| ç­–ç•¥ | é€Ÿåº¦ | å‡†ç¡®æ€§ | é€‚ç”¨åœºæ™¯ |
|------|------|--------|---------|
| **BM25** | âš¡âš¡âš¡ å¿« | â­â­ ä¸­ç­‰ | å…³é”®è¯åŒ¹é…ã€å¿«é€Ÿè¿­ä»£ |
| **å‘é‡æ£€ç´¢** | âš¡âš¡ ä¸­ç­‰ | â­â­â­ é«˜ | è¯­ä¹‰ç†è§£ã€å¤æ‚åœºæ™¯ |
| **æ··åˆæ£€ç´¢** | âš¡âš¡ ä¸­ç­‰ | â­â­â­ é«˜ | **æ¨èä½¿ç”¨**ï¼Œå¹³è¡¡é€Ÿåº¦å’Œå‡†ç¡®æ€§ |

**æ€§èƒ½å¯¹æ¯”**ï¼ˆ1000 æ¡è®­ç»ƒæ•°æ®ï¼‰ï¼š

- BM25ï¼š~0.1 ç§’/æŸ¥è¯¢
- å‘é‡æ£€ç´¢ï¼š~0.3 ç§’/æŸ¥è¯¢
- æ··åˆæ£€ç´¢ï¼š~0.4 ç§’/æŸ¥è¯¢

### è¿­ä»£ä¼˜åŒ–ç­–ç•¥

#### 1. è¿­ä»£æ¬¡æ•°é…ç½®

| åœºæ™¯ | è¿­ä»£æ¬¡æ•° | è¯´æ˜ |
|------|---------|------|
| å¿«é€Ÿæµ‹è¯• | 2 | å¿«é€ŸéªŒè¯åŠŸèƒ½ |
| æ ‡å‡†ä¼˜åŒ– | 4 | å¹³è¡¡é€Ÿåº¦å’Œæ•ˆæœï¼ˆæ¨èï¼‰ |
| æ·±åº¦ä¼˜åŒ– | 6+ | è¿½æ±‚æè‡´æ•ˆæœ |

#### 2. å€™é€‰æ•°é‡é…ç½®

| åœºæ™¯ | å€™é€‰æ•°é‡ | è¯´æ˜ |
|------|---------|------|
| å¿«é€Ÿè¿­ä»£ | 3 | åŠ å¿«å•æ¬¡è¿­ä»£é€Ÿåº¦ |
| æ ‡å‡†ä¼˜åŒ– | 5 | å¹³è¡¡æ¢ç´¢å’Œé€Ÿåº¦ï¼ˆæ¨èï¼‰ |
| æ·±åº¦æ¢ç´¢ | 8+ | æ¢ç´¢æ›´å¤šä¼˜åŒ–å¯èƒ½æ€§ |

### æ€§èƒ½åŸºå‡†æµ‹è¯•

**æµ‹è¯•ç¯å¢ƒ**ï¼š

- CPU: Intel i7-9700K (8 æ ¸)
- RAM: 32GB
- æµ‹è¯•æ•°æ®: 100 ä¸ªå€™é€‰ä»£ç 

**æ€§èƒ½å¯¹æ¯”**ï¼š

| é…ç½® | è¯„ä¼°æ—¶é—´ | æ£€ç´¢æ—¶é—´ | æ€»æ—¶é—´ | æ€§èƒ½æå‡ |
|------|---------|---------|--------|---------|
| æ— ä¼˜åŒ– | 1200s | 45s | 1245s | åŸºå‡† |
| ç¼–è¯‘ç¼“å­˜ | 480s | 45s | 525s | 2.4x |
| ç¼–è¯‘ç¼“å­˜ + å¹¶è¡Œè¯„ä¼° | 180s | 45s | 225s | 5.5x |
| å…¨ä¼˜åŒ– | 180s | 15s | 195s | **6.4x** |

**æ€»ä½“æ€§èƒ½æå‡**ï¼šçº¦ **6.4 å€**

## ğŸ”„ ä¸åŸå§‹ SBLLM çš„åŒºåˆ«

### ä¸»è¦å¢å¼º

| ç‰¹æ€§ | åŸå§‹ SBLLM | RISC-V ç‰ˆæœ¬ |
|------|-----------|------------|
| **æ³¨é‡Šåˆ†æ** | âŒ æ—  | âœ… æ–°å¢ `generate_review_comments()` |
| **è¯„ä¼°ç¯å¢ƒ** | Python åŸç”Ÿç¯å¢ƒ | âœ… QEMU RISC-V ä»¿çœŸç¯å¢ƒ |
| **åŠŸèƒ½éªŒè¯** | è¿”å›ç æ£€æŸ¥ | âœ… è¾“å‡ºæ¯”è¾ƒ + æ•°å€¼å®¹å·® |
| **çŸ¥è¯†åº“æ¥æº** | AST æŠ½è±¡ | âœ… äººå·¥ä¼˜åŒ–è¡¥ä¸æ•°æ®é›† |
| **æ£€ç´¢æ–¹æ³•** | BM25 | âœ… BM25 + å‘é‡æ··åˆæ£€ç´¢ |
| **Prompt æ¨¡æ¿** | é€šç”¨æ¨¡æ¿ | âœ… RISC-V ä¸“ç”¨æ¨¡æ¿ |
| **æ€§èƒ½ä¼˜åŒ–** | åŸºç¡€ | âœ… ç¼–è¯‘ç¼“å­˜ + å¹¶è¡Œè¯„ä¼° |

### å…¼å®¹æ€§

- âœ… **å‘åå…¼å®¹**ï¼šä¿æŒä¸åŸå§‹ SBLLM çš„æ¥å£å…¼å®¹
- âœ… **æ¨¡å¼åˆ‡æ¢**ï¼šé RISC-V æ¨¡å¼ä»å¯ä½¿ç”¨åŸæœ‰è¯„ä¼°ç³»ç»Ÿ
- âœ… **çµæ´»å¯ç”¨**ï¼šé€šè¿‡ `--riscv_mode` æˆ– `--lang riscv` å¯ç”¨ RISC-V åŠŸèƒ½

### ä½¿ç”¨å»ºè®®

- **RISC-V ä»£ç ä¼˜åŒ–**ï¼šä½¿ç”¨ RISC-V æ¨¡å¼ï¼ˆ`--riscv_mode` æˆ– `--lang riscv`ï¼‰
- **Python/C++ ä»£ç ä¼˜åŒ–**ï¼šä½¿ç”¨åŸå§‹æ¨¡å¼ï¼ˆä¸æŒ‡å®š `--riscv_mode`ï¼‰

## ğŸ“– è¯¦ç»†ä½¿ç”¨è¯´æ˜

### æ•°æ®å‡†å¤‡è¯¦ç»†æŒ‡å—

#### è®­ç»ƒæ•°æ®ï¼ˆçŸ¥è¯†åº“ï¼‰å‡†å¤‡

è®­ç»ƒæ•°æ®ç”¨äºæ„å»ºä¼˜åŒ–æ¨¡å¼çŸ¥è¯†åº“ï¼Œæ”¯æŒæ··åˆæ£€ç´¢ã€‚

**å¿…éœ€å­—æ®µ**ï¼š

- `id`: å”¯ä¸€æ ‡è¯†ç¬¦
- `original_code`: åŸå§‹ä»£ç 
- `optimized_code`: ä¼˜åŒ–åçš„ä»£ç 
- `query_abs`: æŠ½è±¡åŒ–åçš„æŸ¥è¯¢ä»£ç ï¼ˆtokenized åˆ—è¡¨ï¼‰
- `edit_code_abs`: åˆ é™¤éƒ¨åˆ†ï¼ˆdsï¼‰çš„æŠ½è±¡è¡¨ç¤ºï¼ˆtokenized åˆ—è¡¨ï¼‰
- `edit_opt_abs`: æ–°å¢éƒ¨åˆ†ï¼ˆdfï¼‰çš„æŠ½è±¡è¡¨ç¤ºï¼ˆtokenized åˆ—è¡¨ï¼‰

**å¯é€‰å­—æ®µ**ï¼š

- `source`: æ¥æºåº“æˆ–é¡¹ç›®
- `optimization_type`: ä¼˜åŒ–ç±»å‹ï¼ˆå¦‚"æ¡ä»¶åˆ†æ”¯ä¼˜åŒ–"ï¼‰
- `optimization_description`: ä¼˜åŒ–æè¿°
- `text_representation`: ç”¨äºå‘é‡æ£€ç´¢çš„æ–‡æœ¬è¡¨ç¤º

**æ•°æ®é¢„å¤„ç†è„šæœ¬ç¤ºä¾‹**ï¼š

```python
import jsonlines
from sbllm.merge import abstract_cpp_code, tokenize_cpp_code

# å¤„ç†è®­ç»ƒæ•°æ®
with jsonlines.open('train_raw.jsonl') as reader, \
     jsonlines.open('train.jsonl', 'w') as writer:
    for obj in reader:
        # æŠ½è±¡åŒ–ä»£ç 
        original_abs = abstract_cpp_code(obj['original_code'])
        optimized_abs = abstract_cpp_code(obj['optimized_code'])
        
        # Tokenize
        query_abs = tokenize_cpp_code(original_abs)
        
        # è®¡ç®—å·®å¼‚ï¼ˆds å’Œ dfï¼‰
        # ... ä½¿ç”¨ diff ç®—æ³•æå– edit_code_abs å’Œ edit_opt_abs
        
        # å†™å…¥å¤„ç†åçš„æ•°æ®
        writer.write({
            'id': obj['id'],
            'original_code': obj['original_code'],
            'optimized_code': obj['optimized_code'],
            'query_abs': query_abs,
            'edit_code_abs': edit_code_abs,
            'edit_opt_abs': edit_opt_abs,
            'text_representation': f"{obj.get('optimization_type', '')} {obj.get('optimization_description', '')}"
        })
```

#### æµ‹è¯•æ•°æ®å‡†å¤‡

æµ‹è¯•æ•°æ®åŒ…å«å¾…ä¼˜åŒ–çš„ RISC-V ä»£ç ã€‚

**å¿…éœ€å­—æ®µ**ï¼š

- `idx`: å”¯ä¸€ç´¢å¼•
- `query`: å¾…ä¼˜åŒ–çš„ RISC-V ä»£ç ï¼ˆ**å¿…é¡»åŒ…å«æ³¨é‡Š**ï¼‰

**å¯é€‰å­—æ®µ**ï¼š

- `reference`: å‚è€ƒä¼˜åŒ–ä»£ç ï¼ˆç”¨äºå¯¹æ¯”ï¼‰
- `input`: æµ‹è¯•è¾“å…¥æ•°æ®

**ç¤ºä¾‹**ï¼š

```json
{
    "idx": 0,
    "query": "# è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—\n# ä¼˜åŒ–æ–¹å‘ï¼šå‡å°‘é€’å½’è°ƒç”¨ï¼Œä½¿ç”¨è¿­ä»£\n.text\n.global fib\nfib:\n    # å‡½æ•°å®ç°...",
    "input": "10"
}
```

### ç»“æœè§£è¯»

#### è¯„ä¼°æŒ‡æ ‡è¯´æ˜

**åŠŸèƒ½æ­£ç¡®æ€§ï¼ˆaccï¼‰**ï¼š

- `1`: åŠŸèƒ½å®Œå…¨æ­£ç¡®ï¼ˆè¾“å‡ºåŒ¹é…ï¼‰
- `0`: åŠŸèƒ½ä¸æ­£ç¡®ï¼ˆè¾“å‡ºä¸åŒ¹é…æˆ–æ‰§è¡Œå¤±è´¥ï¼‰

**æ‰§è¡ŒåŠ é€Ÿæ¯”ï¼ˆspeedup_ratioï¼‰**ï¼š

- å…¬å¼ï¼š`OPT = 1 - new_time / old_time`
- æ­£å€¼ï¼šæ€§èƒ½æå‡
- è´Ÿå€¼ï¼šæ€§èƒ½ä¸‹é™

**ä»£ç ä½“ç§¯ç¼©å‡ç‡ï¼ˆsize_reduction_ratioï¼‰**ï¼š

- å…¬å¼ï¼š`(original_size - new_size) / original_size`
- æ­£å€¼ï¼šä½“ç§¯å‡å°
- è´Ÿå€¼ï¼šä½“ç§¯å¢å¤§

#### ç»“æœæ–‡ä»¶è¯´æ˜

**results.jsonl**ï¼šæœ€ç»ˆä¼˜åŒ–ç»“æœæ±‡æ€»

- `best_result`: æœ€ä½³ä¼˜åŒ–ç»“æœ
- `best_candidates`: æœ€ä½³å€™é€‰åˆ—è¡¨ï¼ˆæŒ‰æ€§èƒ½æ’åºï¼‰
- `pattern`: Similar å’Œ Different Pattern
- `retrieval`: æ£€ç´¢æ¥æºä¿¡æ¯

**test_execution_*.report**ï¼šè¯¦ç»†è¯„ä¼°æŠ¥å‘Š

- åŒ…å«æ‰€æœ‰å€™é€‰çš„è¯„ä¼°ç»“æœ
- åŒ…å«æ‰§è¡Œæ—¶é—´å’Œæ­£ç¡®æ€§ä¿¡æ¯

### æœ€ä½³å®è·µ

#### 1. ä»£ç æ³¨é‡Šç¼–å†™

**å¥½çš„æ³¨é‡Šç¤ºä¾‹**ï¼š

```riscv
# è®¡ç®—æ•°ç»„å…ƒç´ ä¹‹å’Œ
# ä¼˜åŒ–æ–¹å‘ï¼šå‡å°‘å†…å­˜è®¿é—®ï¼Œåˆ©ç”¨ RISC-V æµæ°´çº¿ç‰¹æ€§
# å½“å‰é—®é¢˜ï¼šæ¯æ¬¡å¾ªç¯éƒ½è®¿é—®å†…å­˜ï¼Œå¯èƒ½å¯¼è‡´æµæ°´çº¿åœé¡¿
.text
.global sum_array
sum_array:
    # å‡½æ•°å®ç°...
```

**ä¸å¥½çš„æ³¨é‡Š**ï¼š

```riscv
# æ±‚å’Œå‡½æ•°
.text
```

#### 2. çŸ¥è¯†åº“æ„å»º

- **è´¨é‡ > æ•°é‡**ï¼šä¼˜å…ˆæ”¶é›†é«˜è´¨é‡çš„ä¼˜åŒ–è¡¥ä¸
- **å¤šæ ·æ€§**ï¼šåŒ…å«ä¸åŒç±»å‹çš„ä¼˜åŒ–ï¼ˆåˆ†æ”¯ã€å†…å­˜ã€æŒ‡ä»¤é›†ç­‰ï¼‰
- **æ ‡æ³¨æ¸…æ™°**ï¼šç¡®ä¿ `optimization_type` å’Œ `optimization_description` å‡†ç¡®

#### 3. è¿­ä»£ç­–ç•¥

- **é¦–æ¬¡è¿­ä»£**ï¼šå…³æ³¨åŠŸèƒ½æ­£ç¡®æ€§ï¼Œç¡®ä¿æ‰€æœ‰å€™é€‰éƒ½èƒ½æ­£ç¡®è¿è¡Œ
- **åç»­è¿­ä»£**ï¼šå…³æ³¨æ€§èƒ½æå‡ï¼Œé€æ­¥ä¼˜åŒ–
- **æ”¶æ•›åˆ¤æ–­**ï¼šå½“è¿ç»­ 2 æ¬¡è¿­ä»£æ€§èƒ½æå‡ < 5% æ—¶ï¼Œå¯è€ƒè™‘åœæ­¢

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›æœ¬é¡¹ç›®ã€‚

### è´¡çŒ®æ–¹å¼

1. **æŠ¥å‘Š Bug**ï¼šåœ¨ GitHub Issues ä¸­æŠ¥å‘Šé—®é¢˜
2. **æå‡ºå»ºè®®**ï¼šåˆ†äº«ä½ çš„ä½¿ç”¨ç»éªŒå’Œæ”¹è¿›å»ºè®®
3. **æäº¤ä»£ç **ï¼šé€šè¿‡ Pull Request è´¡çŒ®ä»£ç æ”¹è¿›

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# å…‹éš†ä»“åº“
git clone <repository-url>
cd project1-sbllm

# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirement.txt

# è¿è¡Œæµ‹è¯•
python -m pytest tests/
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ç»§æ‰¿ SBLLM çš„è®¸å¯è¯ï¼ˆè§ LICENSE æ–‡ä»¶ï¼‰ã€‚

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- **GitHub Issues**ï¼šæäº¤é—®é¢˜æˆ–å»ºè®®
- **é¡¹ç›®æ–‡æ¡£**ï¼šæŸ¥çœ‹è¯¦ç»†æ–‡æ¡£å’Œç¤ºä¾‹

## ğŸ“š ç›¸å…³èµ„æº

- **SBLLM åŸå§‹è®ºæ–‡**ï¼šSearch-Based LLMs for Code Optimization (ICSE'25)
- **RISC-V å®˜æ–¹æ–‡æ¡£**ï¼š<https://riscv.org/>
- **QEMU æ–‡æ¡£**ï¼š<https://www.qemu.org/docs/>
- **æµ‹è¯•æ•™ç¨‹**ï¼š`TEST_TUTORIAL.md` - è¯¦ç»†çš„æµ‹è¯•è„šæœ¬ä½¿ç”¨æŒ‡å—
